#!/bin/perl/bin
use strict;

###########################
# usage:
#   perl createtestdata.pl -n 100000 -f xxx

if(! scalar(@ARGV)) {
	print <<USAGE;
Extract the first n sequences from the FASTQ file.

Usage:

  zcat xx.fq.gz | perl create_test_data.pl -n 100000 | gzip > test.fq.gz
  
  -n Number of sequences to extract, default is 20
  -f FASTQ file. If not -f option is set, it will read from STDIN.

The script expects uncompressed fastq file and write fastq file to STDOUT, 
so you should put the command in pipes.
  
USAGE
	
	exit 0;
}

my %param = @ARGV;
$param{"-n"} = $param{"-n"} ? $param{"-n"} + 1 : 21;
my $nrecord = $param{"-n"};

my $file = $param{"-f"};

my $irecord = 0;
my $fh;

if($file) {
	open $fh, $file or die $@;
} else {
	$fh = *STDIN;
}
while(my $line = <$fh>) {
	
	$irecord ++;
	if($irecord % $nrecord == 0) {
		exit 0;
	}
	print $line;
	$line = <$fh>; print $line;
	$line = <$fh>; print $line;
	$line = <$fh>; print $line;

}

